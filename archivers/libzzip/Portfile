# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4

PortSystem          1.0
PortGroup           cmake 1.1
PortGroup           github 1.0

github.setup        gdraheim zziplib 0.13.71 v
name                libzzip
categories          archivers devel
platforms           darwin
license             LGPL
maintainers         {@mojca mojca} openmaintainer
description         library providing read access on ZIP-archives

long_description    The ZZIPlib provides read access on ZIP-archives. The \
                    library uses only the patent-free compression-algorithms \
                    supported by Zlib. It provides functions that transparently \
                    access files being either real files or zipped files, \
                    both with the same filepath.

checksums           rmd160  eee9554167b1d27a0973ccee191df811c6126f43 \
                    sha256  3df044caee3cdeaea3384fe67a452430d92e874dfb5c041c35c1339268025b07 \
                    size    1150828

depends_build-append port:pkgconfig \
                     port:python38

depends_lib         port:zlib

set docdir ${prefix}/share/doc/${name}

configure.python    ${prefix}/bin/python3.8
configure.args      -DBUILD_STATIC_LIBS=ON \
                    -DBUILD_TESTS=OFF \
                    -DZZIPTEST=OFF \
                    -DZZIPSDL=OFF

post-destroot {
    xinstall -d ${destroot}${docdir}/html

    xinstall -m 0644 -W ${worksrcpath} COPYING.LIB ChangeLog README TODO \
        ${destroot}${docdir}

    xinstall -m 0644 {*}[glob -directory ${worksrcpath}/docs "*.{css,htm}"] \
        ${destroot}${docdir}/html
}

variant sdl description {Enable SDL support} {
    depends_lib-append      port:libsdl

    configure.args-replace  -DZZIPSDL=OFF -DZZIPSDL=ON

    post-destroot {
        xinstall -m 0644 ${worksrcpath}/docs/README.SDL ${destroot}${docdir}
    }
}
